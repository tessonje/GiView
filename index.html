<!DOCTYPE html> 
<html>
    <head>
        <meta charset="utf-8">
        <title>GiView</title>
        <link href="jquery.mobile-1.0.min.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script src="jquery-1.6.4.min.js" type="text/javascript"></script>
        <script src="jquery.mobile-1.0.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
        <!--<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />-->
        <script type="text/javascript">
 			function initialize()
			{
				if (navigator.geolocation)
				{
					navigator.geolocation.getCurrentPosition(function(position)
					{	
						
						function Dist(LatA, LngA, LatB, LngB)
  						{
  							rad = function(x) {return x*Math.PI/180;}
							var R     = 6371;
  							var dLat  = rad( LatB - LatA );
  							var dLong = rad( LngB - LngA );
  							var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(rad(LatA)) * Math.cos(rad(LatB)) * Math.sin(dLong/2) * Math.sin(dLong/2);
  							var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  							var d = R * c;
  							return d.toFixed(3);
						}
						map = new google.maps.Map(document.getElementById("map_canvas"),
						{
    						zoom: 15,
        					center: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
        					mapTypeId: google.maps.MapTypeId.ROADMAP
      					});
						
						var myLatlng = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
						var myMarker = new google.maps.Marker(
						{
							position: myLatlng,
							map: map,
							title: "ma position"
						});
						var myWindowOptions = 
						{
							content:
								'it\'s me MARIO'
						};
						var myInfoWindow = new google.maps.InfoWindow(myWindowOptions);
						google.maps.event.addListener(myMarker, 'click', function() 
						{
							myInfoWindow.open(map,myMarker);
						});
						
						var fnacLat =  50.6360722;
						var fnacLon = 3.0647608;
						var user_fnac = dist(position.coords.latitude, position.coords.longitude, 50.6360722, 3.0647608);
						alert("user_fnac");
						var fnacImage = new google.maps.MarkerImage('http://t1.gstatic.com/images?q=tbn:ANd9GcSA9L99C3PR-5UBzPYAOq-nsuD1ddyWzuGN07pJlQCgOOG8heXOjPoKIg');
						var fnacLatlng = new google.maps.LatLng(fnacLat,fnacLon);
						var fnacMarker = new google.maps.Marker(
						{
							position: fnacLatlng, 
							map: map,
							icon: fnacImage,
							title: "fnac Lille"
						});
						var fnacWindowOptions = 
						{
							content:
								'<a href="http://www.fnac.com/">FNAC</a>'
						};
						var fnacInfoWindow = new google.maps.InfoWindow(fnacWindowOptions);
						google.maps.event.addListener(fnacMarker, 'click', function() 
						{
							fnacInfoWindow.open(map,fnacMarker);
						});
						
						var furetLan = 50.6366642;
						var furetLon = 3.0631837;
						var furetImage = new google.maps.MarkerImage('https://pbs.twimg.com/profile_images/195765038/logo_furet_normal.png');
						var furetLatlng = new google.maps.LatLng(furetLan,furetLon);
						var furetMarker = new google.maps.Marker(
						{
							position: furetLatlng, 
							map: map,
							icon: furetImage,
							title: "furet Lille"
						});
						var furetWindowOptions = 
						{
							content:
								'<a href="http://www.furet.com/">FURET</a>'
						};
						var furetInfoWindow = new google.maps.InfoWindow(furetWindowOptions);
						google.maps.event.addListener(furetMarker, 'click', function() 
						{
							furetInfoWindow.open(map,furetMarker);
						});
						
						var epitechLan = 50.6351672;
						var epitechLon = 3.0619123;
						var epitechImage = new google.maps.MarkerImage('https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc3/s48x48/373013_110720126115_1854659391_q.jpg');
						var epitechLatlng = new google.maps.LatLng(epitechLan,epitechLon);
						var epitechMarker = new google.maps.Marker(
						{
							position: epitechLatlng, 
							map: map,
							icon: epitechImage,
							title: "epitech Lille"
						});
						var epitechWindowOptions = 
						{
							content:
								'<a href="http://www.epitech.eu/">EPITECH</a>'
						};
						var epitechInfoWindow = new google.maps.InfoWindow(epitechWindowOptions);
						google.maps.event.addListener(epitechMarker, 'click', function() 
						{
							epitechInfoWindow.open(map,epitechMarker);
						});
						
					})();
				}
				else
					alert("Votre navigateur ne prend pas en compte la g√©olocalisation HTML5");
 				
 			}
		</script>
    </head> 
    <body onload="initialize()">
   		<div data-role="page" id="page">
			<div data-role="header">
				<h1>Page One</h1>
			</div>
			<div data-role="content">	
				<ul data-role="listview">
					<li><a href="#map">map</a></li>
				</ul>
			</div>
			<div data-role="footer">
				<h4>Giview</h4>
			</div>
		</div>
		<div data-role="page" id="map">
			<div data-role="header">
				<h1>map</h1>
			</div>
			<div data-role="content">
				<div id="map_canvas"></div>
			</div>
			<div data-role="footer">
				<a href="#page"><h4>return</h4></a>
			</div>
		</div>    
    </body>
</html>
